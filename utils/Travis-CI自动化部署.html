<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Travis CI Github自动化部署方案 | Liuyun Blog</title>
    <meta name="description" content="个人在前端开发过程中整理的全栈知识">
    <link rel="icon" href="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.cc2a2ebf.css" as="style"><link rel="preload" href="/assets/js/app.179fdb04.js" as="script"><link rel="preload" href="/assets/js/41.e00424d9.js" as="script"><link rel="prefetch" href="/assets/js/23.62c86287.js"><link rel="prefetch" href="/assets/js/2.cda51ec0.js"><link rel="prefetch" href="/assets/js/3.d9e4f004.js"><link rel="prefetch" href="/assets/js/4.89782e16.js"><link rel="prefetch" href="/assets/js/5.b88fe57b.js"><link rel="prefetch" href="/assets/js/6.a593a008.js"><link rel="prefetch" href="/assets/js/7.5de1569e.js"><link rel="prefetch" href="/assets/js/8.fe4249fe.js"><link rel="prefetch" href="/assets/js/9.979c7cc3.js"><link rel="prefetch" href="/assets/js/10.d3c0468d.js"><link rel="prefetch" href="/assets/js/11.78d628ba.js"><link rel="prefetch" href="/assets/js/12.a09bf4c7.js"><link rel="prefetch" href="/assets/js/13.d30963c3.js"><link rel="prefetch" href="/assets/js/14.2f465d9a.js"><link rel="prefetch" href="/assets/js/15.8faf7082.js"><link rel="prefetch" href="/assets/js/16.480ac2ea.js"><link rel="prefetch" href="/assets/js/17.dbd2c19f.js"><link rel="prefetch" href="/assets/js/18.0728f048.js"><link rel="prefetch" href="/assets/js/19.2e57d3d7.js"><link rel="prefetch" href="/assets/js/20.b45cef85.js"><link rel="prefetch" href="/assets/js/21.da673e5a.js"><link rel="prefetch" href="/assets/js/22.0adb5271.js"><link rel="prefetch" href="/assets/js/24.5c80a2bb.js"><link rel="prefetch" href="/assets/js/25.7290e58d.js"><link rel="prefetch" href="/assets/js/26.2767c10d.js"><link rel="prefetch" href="/assets/js/27.89b69b2f.js"><link rel="prefetch" href="/assets/js/28.2cf3b2c5.js"><link rel="prefetch" href="/assets/js/29.2545ca7e.js"><link rel="prefetch" href="/assets/js/30.802a91cb.js"><link rel="prefetch" href="/assets/js/31.1b6da1b5.js"><link rel="prefetch" href="/assets/js/32.9e994f0a.js"><link rel="prefetch" href="/assets/js/33.34ee87b9.js"><link rel="prefetch" href="/assets/js/34.a5fa4c30.js"><link rel="prefetch" href="/assets/js/35.34ae4516.js"><link rel="prefetch" href="/assets/js/36.7d4adbea.js"><link rel="prefetch" href="/assets/js/37.39bfa8e7.js"><link rel="prefetch" href="/assets/js/38.85086c4c.js"><link rel="prefetch" href="/assets/js/39.ec5ca575.js"><link rel="prefetch" href="/assets/js/40.bec19f6e.js"><link rel="prefetch" href="/assets/js/42.45f73e33.js"><link rel="prefetch" href="/assets/js/43.896dfa1e.js"><link rel="prefetch" href="/assets/js/44.cd8a0728.js"><link rel="prefetch" href="/assets/js/45.830001ab.js"><link rel="prefetch" href="/assets/js/46.b9361b43.js"><link rel="prefetch" href="/assets/js/47.67fa6b04.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cc2a2ebf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Liuyun Blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">前端指南</a></div><div class="nav-item"><a href="/utils/" class="nav-link router-link-active">辅助工具</a></div><div class="nav-item"><a href="/full-stack/" class="nav-link">全栈集锦</a></div><div class="nav-item"><a href="/others/" class="nav-link">其他</a></div><div class="nav-item"><a href="https://liuyun012.github.io/xes-wxapp/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  xes-wxapp
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/liuyun012/Js_frame/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">前端指南</a></div><div class="nav-item"><a href="/utils/" class="nav-link router-link-active">辅助工具</a></div><div class="nav-item"><a href="/full-stack/" class="nav-link">全栈集锦</a></div><div class="nav-item"><a href="/others/" class="nav-link">其他</a></div><div class="nav-item"><a href="https://liuyun012.github.io/xes-wxapp/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  xes-wxapp
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/liuyun012/Js_frame/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>辅助工具</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/utils/" class="sidebar-link">Mac Pro 初始开发环境搭建</a></li><li><a href="/utils/markdown语法整理.html" class="sidebar-link">Markdown 语法整理</a></li><li><a href="/utils/Charles的使用.html" class="sidebar-link">Charles的使用教程</a></li><li><a href="/utils/webpack教程及插件汇总.html" class="sidebar-link">Webpack使用问题及资料整理</a></li><li><a href="/utils/Shell编程基础教程.html" class="sidebar-link">Shell编程基础</a></li><li><a href="/utils/npm发包教程及组件按需加载的实现.html" class="sidebar-link">npm发包教程及组件按需加载的实现</a></li><li><a href="/utils/个人博客网站的搭建.html" class="sidebar-link">个人博客网站的详细搭建过程（ Jekyll 和 Hexo）</a></li><li><a href="/utils/前端知识及工具整理.html" class="sidebar-link">前端知识及工具整理</a></li><li><a href="/utils/VSCode插件推荐.html" class="sidebar-link">前端开发工具VSCode常用插件推荐</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="travis-ci-github自动化部署方案"><a href="#travis-ci-github自动化部署方案" aria-hidden="true" class="header-anchor">#</a> Travis CI Github自动化部署方案</h1> <h3 id="参考网址"><a href="#参考网址" aria-hidden="true" class="header-anchor">#</a> 参考网址</h3> <ul><li><a href="https://docs.travis-ci.com/" target="_blank" rel="noopener noreferrer">Travis CI 官网文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html" target="_blank" rel="noopener noreferrer">持续集成服务 Travis CI 教程 - 阮一峰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5a9e1a5751882555712bd8e1" target="_blank" rel="noopener noreferrer">Travis-CI自动化测试并部署至自己的CentOS服务器<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://laravel-china.org/articles/6111/travis-ci-series-automated-deployment-blog?order_by=created_at&" target="_blank" rel="noopener noreferrer">Travis CI 系列：自动化部署博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.csdn.net/ctypyb2002/article/details/80982982" target="_blank" rel="noopener noreferrer">rvm，ruby的安装<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/johnnian/Blog/issues/33" target="_blank" rel="noopener noreferrer">CentOS 安装 Ruby 2.3.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="travis-ci介绍"><a href="#travis-ci介绍" aria-hidden="true" class="header-anchor">#</a> Travis CI介绍</h3> <ul><li>简介： Travis CI 是在软件开发领域中的一个在线的，分布式的持续集成服务，用来构建及测试在GitHub托管的代码，Travis对开源项目是免费，对私有项目是收费的。</li> <li>环境准备
<ul><li>Github 公开项目</li> <li>项目创建 gh-pages 分支</li> <li>确保项目的 <code>Settings</code> 里面的，设置 <code>GitHub Pages</code> 的 Source 为  gh-pages branch。</li></ul></li></ul> <h2 id="travis-自动化部署项目配置流程"><a href="#travis-自动化部署项目配置流程" aria-hidden="true" class="header-anchor">#</a> Travis 自动化部署项目配置流程</h2> <p>一、创建新的 Github 项目代码仓库(或采用已有的项目)
二、注册并配置 Travis CI</p> <ul><li>注册：登录 <a href="https://travis-ci.org/" target="_blank" rel="noopener noreferrer">travis-ci.org<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，点击右上角的个人头像，使用Github第三方授权登录；</li> <li>Travis 会列出 Github 上面你的所有仓库，以及你所属于的组织，选择你需要 Travis 帮你构建的仓库；</li> <li>在 Repositories 选项，选择需要自动化部署的项目。开启build,，也就是点击 ❎ 变成 ✅ 的过程；</li> <li>如果在 Repositories 选项中没有新建的项目，可以点击 Sync account 进行项目同步；</li> <li>点击 选中项目后面的 <code>Settings</code>，在 <code>Environment Variables</code>下面设置全局变量 GITHUB_TOKEN 值为个人的访问令牌</li> <li>个人访问令牌的生成可参考 <a href="https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/" target="_blank" rel="noopener noreferrer">为命令行创建个人访问令牌<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>加密环境变量参考：<a href="https://docs.travis-ci.com/user/environment-variables#Defining-encrypted-variables-in-travisyml" target="_blank" rel="noopener noreferrer">在.travis.yml中加密环境变量<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>三、添加 Travis 配置文件 (.travis.yml)</p> <p>在项目根目录的master 分支里面添加 .travis.yml 配置文件(该文件必须保存在 Github 仓库里面)，基本配置如下：</p> <div class="language-html extra-class"><pre class="language-html"><code># 指定运行环境
language: node_js
# 指定运行的node版本
node_js:
- '8'
# 运行的脚本命令
script:
- yarn build
# 指定监控的分支，只有指定的分支提交时才会运行脚本
branches:
  only:
  - master
# 安装环境依赖和脚本
install:
- yarn install
# 自动化部署命令
deploy:
  provider: pages # 常见快捷部署功能，pages 指代要部署到  Github Pages
  skip-cleanup: true  # 确保已skip-cleanup设置为true, 否则 Travis CI将删除在构建期间创建的所有文件
  github-token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
  target-branch: gh-pages  # 要推送的分支，默认 gh-pages
  local-dir: dist   # 推向分支的文件目录，相对于当前目录
  on:
    branch: master  # 监控的分支
</code></pre></div><p>四、补充说明和使用技巧</p> <ul><li><p>环境变量
.travis.yml的env字段可以定义环境变量</p> <div class="language-html extra-class"><pre class="language-html"><code>env:
- DB=postgres
- SH=bash
- PACKAGE_VERSION=&quot;1.0.*&quot;
</code></pre></div><p>注：有些环境变量(比如用户名和密码)不能公开。可以写在每个仓库的设置页面，Travis 会自动把它们加入环境变量，且只有管理员才能看到变量的值。</p></li> <li><p>加密信息
如果不放心保密信息明文存在 Travis 的网站，可以使用 Travis 提供的加密功能，直接在本地加密变量。</p> <div class="language-html extra-class"><pre class="language-html"><code># 1. 通过 gem 安装 Ruby 的包 travis
$ sudo gem install travis

# 2. 在项目的根目录下，执行 travis encrypt命令
$ travis encrypt SOMEVAR=secretvalue --add env.matrix
</code></pre></div><p>注：上面命令中，<code>SOMEVAR</code>是要加密的变量名，<code>secretvalue</code> 是要加密的变量值，--add参数会把输出自动写入.travis.yml，省掉了修改env字段的步骤。</p></li> <li><p>加密文件
如果要加密的是文件（比如私钥），Travis 提供了加密文件功能。</p></li></ul> <h2 id="自动化部署到个人服务器"><a href="#自动化部署到个人服务器" aria-hidden="true" class="header-anchor">#</a> 自动化部署到个人服务器</h2></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/41.e00424d9.js" defer></script><script src="/assets/js/app.179fdb04.js" defer></script>
  </body>
</html>
